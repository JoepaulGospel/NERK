<!DOCTYPE html>
<html lang="en" id="main-html" class="light">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>NERK | KODEBLOCK Edition</title>
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://unpkg.com/lucide@latest"></script>
<!-- SDKS -->
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-auth-compat.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;700;800&display=swap" rel="stylesheet">
<script>
tailwind.config = {
darkMode: 'class',
theme: { extend: { colors: { darkbg: '#09090b', darkcard: '#18181b' } } }
}
</script>
<style>
body { font-family: 'Plus Jakarta Sans', sans-serif; transition: background 0.3s ease; overflow-x: hidden; }
.glass { background: rgba(255, 255, 255, 0.7); backdrop-filter: blur(20px); border: 1px solid rgba(255,255,255,0.4); }
.dark .glass { background: rgba(24, 24, 27, 0.6); border: 1px solid rgba(255,255,255,0.1); }
.traffic-dot { transition: all 0.4s ease; width: 20px; height: 20px; border-radius: 50%; background: #3f3f46; }
.light-active-green { background: #22c55e !important; box-shadow: 0 0 20px #22c55e; }
.light-active-yellow { background: #eab308 !important; box-shadow: 0 0 20px #eab308; }
.light-active-red { background: #ef4444 !important; box-shadow: 0 0 20px #ef4444; }
.hide { display: none !important; }
.calendar-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 4px; }
.calendar-day { aspect-ratio: 1; display: flex; align-items: center; justify-content: center; font-size: 9px; font-weight: 800; border-radius: 10px; transition: 0.3s; }
.day-active { background: #22c55e; color: white; box-shadow: 0 0 15px rgba(34, 197, 94, 0.4); }
</style>
</head>
<body class="bg-[#f4f4f7] dark:bg-darkbg text-zinc-900 dark:text-zinc-100 min-h-screen">
<!-- AUTH -->
<section id="auth-screen" class="min-h-screen flex items-center justify-center p-6">
<div class="w-full max-w-md space-y-12 text-center">
<div class="space-y-2">
<h1 class="text-6xl font-black tracking-tighter">NERK</h1>
<p class="text-[10px] font-black uppercase tracking-[0.4em] text-zinc-400">NERK FROM KODEBLOCK</p>
</div>
<div class="glass p-8 rounded-[3rem] space-y-5 shadow-2xl border-white/50">
<input id="auth-email" type="email" placeholder="Gmail Address" class="w-full p-5 rounded-[1.5rem] bg-zinc-100/50 dark:bg-zinc-800/50 outline-none font-bold text-sm">
<input id="auth-pass" type="password" placeholder="Password (Min. 6)" class="w-full p-5 rounded-[1.5rem] bg-zinc-100/50 dark:bg-zinc-800/50 outline-none font-bold text-sm">
<button onclick="handleAuth('login')" id="login-btn" class="w-full bg-zinc-900 dark:bg-white dark:text-black text-white p-5 rounded-[1.5rem] font-black shadow-xl active:scale-95 transition-transform">LOG IN</button>
<button onclick="handleAuth('signup')" class="text-[10px] font-black text-zinc-400 hover:text-indigo-500 uppercase tracking-[0.2em] pt-2">Create New Account</button>
</div>
</div>
</section>
<!-- DASHBOARD -->
<section id="dashboard" class="hide p-4 md:p-6 pb-44 max-w-6xl mx-auto animate-in fade-in">
<div class="grid grid-cols-1 lg:grid-cols-[1fr_320px] gap-6">
<div class="space-y-6">
<header class="flex justify-between items-center pt-4">
<div class="flex items-center gap-3">
<div onclick="toggleDarkMode()" class="w-12 h-12 glass rounded-2xl flex items-center justify-center cursor-pointer shadow-sm">
<i data-lucide="moon" class="w-5 h-5 dark:hide"></i>
<i data-lucide="sun" class="w-5 h-5 hide dark:block text-yellow-400"></i>
</div>
<button onclick="downloadStatement()" class="w-12 h-12 glass rounded-2xl flex items-center justify-center shadow-sm">
<i data-lucide="file-down" class="w-5 h-5"></i>
</button>
</div>
<div class="text-right">
<h2 class="text-2xl font-black tracking-tighter uppercase">NERK</h2>
<p class="text-[8px] font-black uppercase tracking-widest text-zinc-400">NERK FROM KODEBLOCK</p>
</div>
</header>
<div class="flex items-center gap-2">
<input type="month" id="month-filter" onchange="init()" class="glass px-4 py-3 rounded-2xl text-[10px] font-bold outline-none flex-1">
<button onclick="auth.signOut()" class="w-10 h-10 glass rounded-2xl flex items-center justify-center text-red-500">
<i data-lucide="log-out" class="w-4 h-4"></i>
</button>
</div>
<!-- BALANCE CARD -->
<div class="glass rounded-[2.5rem] p-8 md:p-10 shadow-2xl flex justify-between items-center relative">
<div class="space-y-1">
<div class="flex items-center gap-2">
<p id="status-text" class="text-[9px] font-black uppercase tracking-widest text-green-500">Initializing...</p>
<button onclick="setNewBudget()" class="p-1 hover:bg-zinc-100 dark:hover:bg-zinc-800 rounded-md">
<i data-lucide="edit-3" class="w-3 h-3 text-zinc-400"></i>
</button>
</div>
<p class="text-[10px] font-medium text-zinc-400">Remaining Capital</p>
<h2 id="display-balance" class="text-3xl md:text-4xl font-black tracking-tighter">₦0</h2>
</div>
<!-- THE LIGHTS -->
<div class="flex flex-col gap-3 bg-zinc-200/50 dark:bg-zinc-800/50 p-2.5 rounded-full border border-black/5">
<div id="light-red" class="traffic-dot"></div>
<div id="light-yellow" class="traffic-dot"></div>
<div id="light-green" class="traffic-dot"></div>
</div>
</div>
<div class="grid grid-cols-2 gap-3">
<div class="glass p-6 rounded-[2rem] shadow-sm">
<p class="text-[8px] font-black text-zinc-400 uppercase tracking-widest mb-1">Target Budget</p>
<p id="display-budget" class="text-sm font-bold tracking-tight">₦0</p>
</div>
<div class="bg-zinc-900 dark:bg-white dark:text-black p-6 rounded-[2rem] shadow-xl text-white">
<p class="text-[8px] font-black opacity-50 uppercase tracking-widest mb-1">Current Burn</p>
<p id="display-spent" class="text-sm font-bold tracking-tight">₦0</p>
</div>
</div>
<div id="expense-list" class="space-y-3"></div>
</div>
<div class="space-y-6">
<div class="glass rounded-[2rem] p-6 pt-10 sticky top-6">
<h3 class="text-[9px] font-black uppercase tracking-[0.3em] text-zinc-400 mb-6 text-center">Temporal Index</h3>
<div id="calendar-title" class="text-sm font-black text-center mb-6 uppercase tracking-tighter">January 2026</div>
<div class="calendar-grid text-[8px] font-black text-zinc-400 mb-4 uppercase text-center opacity-40">
<span>S</span><span>M</span><span>T</span><span>W</span><span>T</span><span>F</span><span>S</span>
</div>
<div id="calendar-days" class="calendar-grid"></div>
<div class="mt-8 pt-6 border-t border-zinc-200 dark:border-zinc-800 flex justify-between items-center">
<span class="text-[9px] font-black uppercase tracking-widest opacity-60">Daily Velocity</span>
<span id="stat-avg" class="text-xs font-black">₦0</span>
</div>
</div>
</div>
</div>
<!-- FIXED INPUT -->
<div class="fixed bottom-8 left-0 w-full px-6 flex justify-center z-50">
<div class="w-full max-w-md glass p-2 md:p-3 rounded-[3rem] shadow-2xl flex items-center gap-3 border-white/40">
<span class="ml-5 font-black text-lg text-zinc-400">₦</span>
<input id="amount-input" type="number" placeholder="0.00" class="flex-1 bg-transparent py-4 font-bold text-xl outline-none">
<button onclick="addExpense()" id="add-btn" class="bg-zinc-900 dark:bg-white dark:text-black text-white w-14 h-14 md:w-16 md:h-16 rounded-full flex items-center justify-center shadow-lg transition-all active:scale-90">
<i data-lucide="plus" id="plus-icon" class="w-8 h-8"></i>
</button>
</div>
</div>
</section>
<script>
// CONFIG
const firebaseConfig = {
apiKey: "AIzaSyA0_1qvuG5TGiS2HM8E-lXOmL1ri0T2658",
authDomain: "nerk-4ca89.firebaseapp.com",
projectId: "nerk-4ca89",
storageBucket: "nerk-4ca89.firebasestorage.app",
messagingSenderId: "913086486476",
appId: "1:913086486476:web:dbf3424285fdfa0ac1ef69"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();
const auth = firebase.auth();
let user = null;
let budget = 0;
let totalSpent = 0;
let currentExpenses = [];
auth.onAuthStateChanged(u => {
user = u;
if (u) {
document.getElementById('auth-screen').classList.add('hide');
document.getElementById('dashboard').classList.remove('hide');
const now = new Date();
document.getElementById('month-filter').value = `${now.getFullYear()}-${String(now.getMonth()+1).padStart(2,'0')}`;
init();
} else {
document.getElementById('auth-screen').classList.remove('hide');
document.getElementById('dashboard').classList.add('hide');
}
});
async function handleAuth(type) {
const email = document.getElementById('auth-email').value.trim();
const pass = document.getElementById('auth-pass').value;
const btn = document.getElementById('login-btn');
if(!email || !pass) return alert("System requires email and password.");
btn.innerText = "AUTHENTICATING...";
try {
if (type === 'signup') await auth.createUserWithEmailAndPassword(email, pass);
else await auth.signInWithEmailAndPassword(email, pass);
} catch (e) { alert(e.message); btn.innerText = "LOG IN"; }
}
function toggleDarkMode() { document.getElementById('main-html').classList.toggle('dark'); }
function init() {
lucide.createIcons();
fetchBudget();
fetchExpenses();
renderCalendar();
}
async function fetchBudget() {
if(!user) return;
const doc = await db.collection("budgets").doc(user.uid).get();
budget = doc.exists ? Number(doc.data().amount) : 0;
calculateTraffic();
}
async function setNewBudget() {
const val = prompt("Enter Monthly Infrastructure Capital:", budget);
if (val !== null && !isNaN(val)) {
budget = Number(val);
await db.collection("budgets").doc(user.uid).set({ amount: budget });
calculateTraffic();
}
}
function renderCalendar() {
const filter = document.getElementById('month-filter').value;
const [year, month] = filter.split('-').map(Number);
const date = new Date(year, month - 1, 1);
const lastDay = new Date(year, month, 0).getDate();
const startDay = date.getDay();
const calDays = document.getElementById('calendar-days');
const calTitle = document.getElementById('calendar-title');
calTitle.innerText = date.toLocaleString('default', { month: 'long', year: 'numeric' });
calDays.innerHTML = '';
for (let i = 0; i < startDay; i++) { calDays.innerHTML += '<div></div>'; }
const now = new Date();
for (let day = 1; day <= lastDay; day++) {
const isToday = now.getDate() === day && now.getMonth() === month-1 && now.getFullYear() === year;
calDays.innerHTML += `<div class="calendar-day ${isToday ? 'day-active' : 'bg-zinc-100/50 dark:bg-zinc-800/50'}">${day}</div>`;
}
}
function fetchExpenses() {
if(!user) return;
const monthFilter = document.getElementById('month-filter').value;
const [year, month] = monthFilter.split('-');
const start = new Date(year, month - 1, 1);
const end = new Date(year, month, 0, 23, 59, 59);
db.collection("expenses")
.where("uid", "==", user.uid)
.where("createdAt", ">=", start)
.where("createdAt", "<=", end)
.onSnapshot(snap => {
const list = document.getElementById('expense-list');
list.innerHTML = ''; totalSpent = 0; currentExpenses = [];
snap.forEach(doc => {
const data = doc.data();
currentExpenses.push(data);
totalSpent += Number(data.amount);
const item = document.createElement('div');
item.className = "glass p-5 rounded-[1.8rem] flex justify-between items-center shadow-sm";
item.innerHTML = `<div class="flex items-center gap-4 text-[9px] font-black uppercase tracking-widest"><i data-lucide="zap" class="w-4 h-4 text-indigo-500"></i> Burn Log</div><span class="font-black">-₦${data.amount.toLocaleString()}</span>`;
list.appendChild(item);
});
lucide.createIcons();
calculateTraffic();
updateStats();
});
}
function calculateTraffic() {
const spent = Number(totalSpent);
const limit = Number(budget);
const balance = limit - spent;
const ratio = limit > 0 ? (spent / limit) : 0;
document.getElementById('display-balance').innerText = `₦${balance.toLocaleString()}`;
document.getElementById('display-spent').innerText = `₦${spent.toLocaleString()}`;
document.getElementById('display-budget').innerText = `₦${limit.toLocaleString()}`;
const r = document.getElementById('light-red'), y = document.getElementById('light-yellow'), g = document.getElementById('light-green');
const st = document.getElementById('status-text');
// RESET LIGHTS
[r, y, g].forEach(l => {
l.classList.remove('light-active-green', 'light-active-yellow', 'light-active-red');
});
if (limit === 0) {
st.innerText = "Set a budget";
st.className = "text-[9px] font-black uppercase tracking-widest text-zinc-400";
return;
}
if (ratio < 0.5) {
g.classList.add('light-active-green');
st.innerText = "Safe Zone";
st.className = "text-[9px] font-black uppercase tracking-widest text-green-500";
}
else if (ratio < 0.9) {
y.classList.add('light-active-yellow');
st.innerText = "Caution";
st.className = "text-[9px] font-black uppercase tracking-widest text-yellow-500";
}
else {
r.classList.add('light-active-red');
st.innerText = "Danger Zone";
st.className = "text-[9px] font-black uppercase tracking-widest text-red-500";
}
}
// THE FIXED ADD FUNCTION
async function addExpense() {
const input = document.getElementById('amount-input');
const amount = Number(input.value);
const btn = document.getElementById('add-btn');
if (!amount || amount <= 0) return;
if (!user) return alert("System Error: No user authenticated.");
btn.disabled = true;
btn.innerHTML = '<i data-lucide="loader" class="w-6 h-6 animate-spin"></i>';
lucide.createIcons();
try {
await db.collection("expenses").add({
amount: amount,
uid: user.uid,
createdAt: firebase.firestore.Timestamp.now()
});
input.value = '';
} catch (e) {
alert("Infrastructure Error: " + e.message);
} finally {
btn.disabled = false;
btn.innerHTML = '<i data-lucide="plus" class="w-8 h-8"></i>';
lucide.createIcons();
}
}
function updateStats() {
const dayOfMonth = new Date().getDate();
const avg = totalSpent / dayOfMonth;
document.getElementById('stat-avg').innerText = `₦${avg.toFixed(2)}`;
}
function downloadStatement() {
const month = document.getElementById('month-filter').value;
let csv = `Date,Amount\n`;
currentExpenses.forEach(exp => {
const date = exp.createdAt.toDate().toLocaleDateString();
csv += `${date},${exp.amount}\n`;
});
const blob = new Blob([csv], { type: 'text/csv' });
const url = window.URL.createObjectURL(blob);
const a = document.createElement('a');
a.setAttribute('href', url);
a.setAttribute('download', `NERK_Statement_${month}.csv`);
a.click();
}
</script>
</body>
</html>
